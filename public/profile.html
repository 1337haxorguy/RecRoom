<!DOCTYPE html>
<html>
<head>
  	<meta charset="utf-8">
  	<meta name="viewport" content="initial-scale=1, width=device-width">
  	
  	<link rel="stylesheet"  href="./styles/profile.css" />
  	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Helvetica Neue:wght@400&display=swap" />
  	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Instrument Serif:wght@400&display=swap" />
  	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=PP Neue Montreal:wght@400;500&display=swap" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

  	
  	
  	
</head>
<body>

	 

  	<div class="iphone-13-mini-1">
    		<div class="iphone-13-mini-1-inner">
              <a href="">
      			<div class="rilink-parent">
					<i class="fa-solid fa-link"></i>
        				<div class="recroomme">recroom.me/sophdelrosario</div>
      			</div>
			  </a>
    		</div>
    		<div class="iphone-13-mini-1-child">
      			<div class="overview-parent">
        				<div class="overview">Overview</div>
        				<div class="frame-parent">
          					<div class="science-fiction-wrapper">
            						<div class="introButton" 
                        >Science fiction</div>
          					</div>
          					<div class="fantasy-wrapper">
            						<div class="science-fiction">Fantasy</div>
          					</div>
          					<div class="fantasy-wrapper">
            						<div class="science-fiction">Romance</div>
          					</div>
          					<div class="alternative-rock-wrapper">
            						<div class="science-fiction">Rock</div>
          					</div>
          					<div class="fantasy-wrapper">
            						<div class="science-fiction">Comedy</div>
          					</div>
          					<div class="fantasy-wrapper">
            						<div class="science-fiction">Comedy</div>
          					</div>
        				</div>
      			</div>
    		</div>
    		<div class="tv-shows-parent">
      			<div class="tv-shows">TV Shows </div>
      			<div class="image">
        				<div class="friends">Friends</div>
      			</div>
                <div class="image1-wrapper">
                    <div class="image1">
                        <div class="cobra-kai">Cobra Kai</div>
                </div>
                <div class="image1">
                        <div class="queen-of-the">Queen of the South</div>
                </div>

                </div>
      			<div class="more-tv-shows-parent">
        				<div class="more-tv-shows">More TV shows</div>
        				<div class="thats-so-true-gracie-abrams-wrapper">
          					<div class="thats-so-true">Gilmore Girls</div>
        				</div>
        				<div class="thats-so-true-gracie-abrams-wrapper">
          					<div class="thats-so-true">How I Met Your Mother</div>
        				</div>
        				<div class="thats-so-true-gracie-abrams-wrapper">
          					<div class="thats-so-true">Nobody Wants This</div>
        				</div>
        				<div class="frame-div">
          					<div class="thats-so-true">Arcane: League of Legends</div>
        				</div>
        				<div class="thats-so-true-gracie-abrams-wrapper">
          					<div class="thats-so-true">Cobra Kai</div>
        				</div>
      			</div>
    		</div>
    		<div class="songs-parent">
      			<div class="songs">Songs </div>
      			<div class="image">
        				<div class="friends">Espresso</div>
        				<div class="sabrina-carpenter">Sabrina Carpenter</div>
      			</div>
      			<div class="image1">
        				<div class="solo-dates">Solo Dates</div>
        				<div class="fig">Fig</div>
      			</div>
      			<div class="image1">
        				<div class="apt">APT.</div>
        				<div class="rose-ft-bruno">Rose ft. Bruno Mars</div>
      			</div>
      			<div class="more-tv-shows-parent">
        				<div class="more-tv-shows">More songs</div>
        				<div class="thats-so-true-gracie-abrams-wrapper">
          					<div class="thats-so-true">Thatâ€™s So True - Gracie Abrams </div>
        				</div>
        				<div class="thats-so-true-gracie-abrams-wrapper">
          					<div class="thats-so-true">Alaska - Maggie Rogers</div>
        				</div>
        				<div class="thats-so-true-gracie-abrams-wrapper">
          					<div class="thats-so-true">Buzz - Niki</div>
        				</div>
        				<div class="frame-div">
          					<div class="thats-so-true">Naked in Manhattan - Chappell Roan</div>
        				</div>
        				<div class="thats-so-true-gracie-abrams-wrapper">
          					<div class="thats-so-true">Quicksand - SZA</div>
        				</div>
      			</div>
    		</div>
    		<div class="movies-parent">
      			<div class="songs">Movies</div>

                <div class="image1">
        				<div class="solo-dates">John Wick</div>
      			</div>
                <div>
                <div class="image1">
        				<div class="apt">Tangled</div>
                </div>
                <div class="image">
                    <div class="friends">La La Land</div>
              </div >

                </div>
      			<div class="more-tv-shows-parent">
        				<div class="more-tv-shows">More Movies</div>
        				<div class="thats-so-true-gracie-abrams-wrapper">
          					<div class="thats-so-true">Knives Out</div>
        				</div>
        				<div class="thats-so-true-gracie-abrams-wrapper">
          					<div class="thats-so-true">Spiderman: Homecoming</div>
        				</div>
        				<div class="thats-so-true-gracie-abrams-wrapper">
          					<div class="thats-so-true">The Platform</div>
        				</div>
        				<div class="frame-div">
          					<div class="thats-so-true">Aftersun</div>
        				</div>
        				<div class="thats-so-true-gracie-abrams-wrapper">
          					<div class="thats-so-true">Midsommar</div>
        				</div>
      			</div>
    		</div class="frame-group">
    		<img class="iphone-13-mini-1-item" alt="" src="./assets/logo.png">
    		
    		<div class="my-rec-room">My Rec Room</div>
    		<div class="created-for-hackru-container">
      			<p class="created-for-hackru">Created for HackRU</p>
      			<p class="created-for-hackru">By Team RAMS</p>
    		</div>
  	</div>
  	
  	<script>
document.addEventListener('DOMContentLoaded', function() {
    // Function to get background style with cover image
    function getBackgroundStyle(href) {
        console.log(`Applying background with href: ${href}`);

    return `
        background-image: linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url(${href});
        background-size: cover;
        background-position: center;
        min-height: 150px;
        position: relative;
        border-radius: 8px;
        overflow: hidden;

    `;
}


    // Function to create overlay div for text
    function createTextOverlay(text, href) {
    const overlay = `
        <div class="friends text-truncate" style="
            position: absolute;
            bottom: 10px;
            left: 10px;
            z-index: 2;
        ">${text}</div>
        <div style="
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(transparent 50%, rgba(0,0,0,0.7));
            z-index: 1;
        "></div>
    `;
    return overlay;
}

    async function getCoverImageTV(show) {
        const response = await fetch('/api/getCoverImageTV', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ input: show })
        });
        const data = await response.json();
        return data; // Assuming the first element contains the image URL
    }

    async function getCoverImageMovie(movie) {
        const response = await fetch('/api/getCoverImageMovie', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ input: movie })
        });
        const data = await response.json();
        return data; // Assuming the first element contains the image URL
    }


    // Function to load selections from localStorage
    async function loadSelections() {
        const tvShows = JSON.parse(localStorage.getItem('selected_tv') || '[]');
        const movies = JSON.parse(localStorage.getItem('selected_movies') || '[]');
        
        await updateTVShowsSection(tvShows);
        await updateMoviesSection(movies);
    }

    // Function to update TV Shows section
    async function updateTVShowsSection(shows) {
        const tvSection = document.querySelector('.tv-shows-parent');
        if (!tvSection) return;

        // Clear existing featured shows
        const existingShows = tvSection.querySelectorAll('.image, .image1');
        existingShows.forEach(show => show.remove());

        // Update featured shows (up to first 3)
        const featuredShows = shows.slice(0, 3);
        for (let i = 0; i < featuredShows.length; i++) {
            const show = featuredShows[i];
            const showDiv = document.createElement('div');
            showDiv.className = i === 0 ? 'image' : 'image1';
            
            try {
                const href = await getCoverImageTV(show);
                showDiv.style.cssText = getBackgroundStyle(href);
                showDiv.innerHTML = createTextOverlay(show);
            } catch (error) {
                console.error(`Error loading cover for ${show}:`, error);
                showDiv.innerHTML = `<div class="friends">${show}</div>`;
            }
            
            const tvShowsHeading = tvSection.querySelector('.tv-shows');
            tvShowsHeading.parentNode.insertBefore(showDiv, tvShowsHeading.nextSibling);
        }

        // Update "More TV shows" section
        const moreTVShows = shows.slice(3);
        const moreSection = tvSection.querySelector('.more-tv-shows-parent');
        if (moreSection) {
            const heading = moreSection.querySelector('.more-tv-shows');
            moreSection.innerHTML = '';
            moreSection.appendChild(heading);

            moreTVShows.forEach(show => {
                const showDiv = document.createElement('div');
                showDiv.className = 'thats-so-true-gracie-abrams-wrapper';
                showDiv.innerHTML = `<div class="thats-so-true">${show}</div>`;
                moreSection.appendChild(showDiv);
            });
        }
    }

    // Function to update Movies section
    async function updateMoviesSection(movies) {
        const movieSection = document.querySelector('.movies-parent');
        if (!movieSection) return;

        // Clear existing featured movies
        const existingMovies = movieSection.querySelectorAll('.image, .image1');
        existingMovies.forEach(movie => movie.remove());

        // Update featured movies (up to first 3)
        const featuredMovies = movies.slice(0, 3);
        for (let i = 0; i < featuredMovies.length; i++) {
            const movie = featuredMovies[i];
            const movieDiv = document.createElement('div');
            movieDiv.className = i === 0 ? 'image' : 'image1';
            
            try {
                const href = await getCoverImageMovie(movie);
                movieDiv.style.cssText = getBackgroundStyle(href);
                movieDiv.innerHTML = createTextOverlay(movie);
            } catch (error) {
                console.error(`Error loading cover for ${movie}:`, error);
                movieDiv.innerHTML = `<div class="${i === 0 ? 'friends' : 'solo-dates'}">${movie}</div>`;
            }
            
            const moviesHeading = movieSection.querySelector('.songs');
            moviesHeading.parentNode.insertBefore(movieDiv, moviesHeading.nextSibling);
        }

        // Update "More movies" section
        const moreMovies = movies.slice(3);
        const moreSection = movieSection.querySelector('.more-tv-shows-parent');
        if (moreSection) {
            const heading = moreSection.querySelector('.more-tv-shows');
            moreSection.innerHTML = '';
            moreSection.appendChild(heading);

            moreMovies.forEach(movie => {
                const movieDiv = document.createElement('div');
                movieDiv.className = 'thats-so-true-gracie-abrams-wrapper';
                movieDiv.innerHTML = `<div class="thats-so-true">${movie}</div>`;
                moreSection.appendChild(movieDiv);
            });
        }
    }

    // Load initial selections
    loadSelections();

    // Optional: Add a periodic check for updates
});    </script>
</body>
</html>
